% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mfp_step.R
\name{compute_decision}
\alias{compute_decision}
\title{Compute Model Selection Decision}
\usage{
compute_decision(metrics, criterion, select, n_obs, ftest = FALSE)
}
\arguments{
\item{metrics}{A list containing model fit statistics for three candidate models:
\itemize{
\item \code{metrics1}: statistics for the most complex model selected in stage 1 of the SAZ algorithm, typically including both FPm/linear and binary terms.
\item \code{metrics2}: statistics for a reduced model, e.g., FPm/linear only.
\item \code{metrics3}: statistics for an alternative reduced model, e.g., binary only.
Each element must provide named values for:
\item \code{logl}: log-likelihood,
\item \code{df}: model degrees of freedom,
\item \code{aic}: Akaike Information Criterion,
\item \code{bic}: Bayesian Information Criterion,
\item \code{deviance_gaussian}: Gaussian deviance (required if \code{ftest = TRUE}),
\item \code{df_resid}: residual degrees of freedom (required if \code{ftest = TRUE}).
}}

\item{criterion}{A string specifying the selection criterion.
One of \code{"pvalue"}, \code{"aic"}, or \code{"bic"}.}

\item{select}{Numeric threshold for significance testing (used only when
\code{criterion = "pvalue"}).}

\item{n_obs}{Integer. Number of observations in the data (used for F-tests).}

\item{ftest}{Logical. If \code{TRUE}, use F-tests instead of likelihood ratio
tests when \code{criterion = "pvalue"}.}
}
\value{
A list with two elements:
\itemize{
\item \code{decision}: An integer indicating the selected model
(1 = both terms, 2 = FPm/linear only, 3 = binary only).
\item \code{pvalue}: A numeric vector of p-values from the pairwise tests,
or \code{NA} when \code{criterion} is \code{"aic"} or \code{"bic"}.
}
}
\description{
This function compares competing regression models based on a specified
selection criterion (\code{pvalue}, \code{aic}, or \code{bic}) and returns a decision
about which model to retain. It is used in stage 2 of the
spike-at-zero (SAZ) algorithm, where a decision is made between alternative
reduced or complex models after stage 1 selection.
}
\details{
\itemize{
\item When \code{criterion = "pvalue"}, the function compares:
\itemize{
\item Model 1 (both FPm/linear and binary terms),
\item Model 2 (FPm/linear only),
\item Model 3 (binary only).
Significance is determined by comparing complex vs. reduced models
using either likelihood ratio tests or F-tests.
}
\item When \code{criterion = "aic"} or \code{"bic"}, the function selects the model
with the lowest information criterion value.
}
}
\keyword{internal}
