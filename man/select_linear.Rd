% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mfp_step.R
\name{select_linear}
\alias{select_linear}
\title{Helper to select between null and linear term for a single variable}
\usage{
select_linear(
  x,
  xi,
  y,
  powers_current,
  powers,
  keep,
  criterion,
  ftest,
  acdx,
  select,
  ...
)
}
\value{
A list with several components:
\itemize{
\item \code{keep}: logical indicating if \code{xi} is forced into model.
\item \code{acd}: logical indicating if an ACD transformation was applied for \code{xi}.
\item \code{powers}: fp powers investigated in step, indexing \code{metrics}.
\item \code{power_best}: a numeric vector with the best power found. The returned
best power may be \code{NA}, indicating the variable has been removed from the
model.
\item \code{metrics}: a matrix with performance indices for all models investigated.
Same number of rows as, and indexed by, \code{powers}.
\item \code{model_best}: row index of best model in \code{metrics}.
\item \code{pvalue}: p-value for comparison of linear and null model.
\item \code{statistic}: test statistic used, depends on \code{ftest}.
}
}
\description{
To be used in \code{\link[=find_best_fp_step]{find_best_fp_step()}}. Only used if \code{df = 1} for a variable.
Handles all criteria for selection.
For parameter explanations, see \code{\link[=find_best_fp_step]{find_best_fp_step()}}. All parameters
captured by \code{...} are passed on to \code{\link[=fit_model]{fit_model()}}.
}
\details{
This function assesses a single variable of interest \code{xi} regarding its
functional form in the current working model as indicated by
\code{powers_current}, with the choice between a excluding \code{xi} ("null model") and
including a linear term ("linear fp") for \code{xi}.

Note that this function handles an ACD transformation for \code{xi} as well.

When a variable is forced into the model by including it in \code{keep}, then
this function will not exclude it from the model (by setting its power to
\code{NA}), but will only choose the linear model.
}
