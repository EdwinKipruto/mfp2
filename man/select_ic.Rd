% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mfp_step.R
\name{select_ic}
\alias{select_ic}
\alias{select_ic_acd}
\title{Function selection procedure based on information criteria}
\usage{
select_ic(x, xi, degree, y, powers_current, keep, criterion, powers, acdx, ...)

select_ic_acd(
  x,
  xi,
  degree,
  y,
  powers_current,
  keep,
  criterion,
  powers,
  acdx,
  ...
)
}
\value{
A list with several components:
\itemize{
\item \code{keep}: logical indicating if \code{xi} is forced into model.
\item \code{acd}: logical indicating if an ACD transformation was applied for \code{xi},
i.e. \code{FALSE} in this case.
\item \code{powers}: (best) fp powers investigated in step, indexing \code{metrics}.
\item \code{power_best}: a numeric vector with the best power found. The returned
best power may be \code{NA}, indicating the variable has been removed from the
model.
\item \code{metrics}: a matrix with performance indices for all best models
investigated. Same number of rows as, and indexed by, \code{powers}.
\item \code{model_best}: row index of best model in \code{metrics}.
\item \code{pvalue}: p-value for comparison of linear and null model, \code{NA} in this
case..
\item \code{statistic}: test statistic used, depends on \code{ftest}, \code{NA} in this
case.
}
}
\description{
Used in \code{\link[=find_best_fp_step]{find_best_fp_step()}} when \code{criterion = "aic"} or \code{"bic"}.
For parameter explanations, see \code{\link[=find_best_fp_step]{find_best_fp_step()}}. All parameters
captured by \code{...} are passed on to \code{\link[=fit_model]{fit_model()}}.
}
\details{
In case an information criterion is used to select the best model the
selection procedure simply fits all relevant models and selects the best
one according to the given criterion.

"Relevant" models for a given degree are the null model excluding the
variable of interest, the linear model and all best FP models up to the
specified degree.

In case an ACD transformation is requested, then the models assessed
are the null model, the linear model in x and A(x), the best FP1 models in
x and A(x), and the best FP1(x, A(x)) model.

Note that the "best" FPx model used in this function are given by the models
using a FPx transformation for the variable of interest and having the
highest likelihood of all such models given the current powers for all other
variables, as outlined in Section 4.8 of Royston and Sauerbrei (2008).
These best FPx models are computed in \code{\link[=find_best_fpm_step]{find_best_fpm_step()}}.
Keep in mind that for a fixed number of degrees of freedom (i.e. fixed m),
the model with the highest likelihood is the same as the model with the best
information criterion of any kind since all the models share the same
penalty term.

When a variable is forced into the model by including it in \code{keep}, then
this function will not exclude it from the model (by setting its power to
\code{NA}), but will only choose its functional form.
}
\section{Functions}{
\itemize{
\item \code{select_ic_acd}: Function to select ACD based transformation.
}}

\seealso{
\code{\link[=select_ra2]{select_ra2()}}
}
