% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_mfp.R
\name{find_best_fp_cycle}
\alias{find_best_fp_cycle}
\title{Helper to run cycles of the mfp algorithm}
\usage{
find_best_fp_cycle(
  x,
  y,
  powers_current,
  df,
  weights,
  offset,
  family,
  criterion,
  select,
  alpha,
  keep,
  powers,
  method,
  strata,
  verbose,
  ftest,
  control,
  rownames,
  nocenter,
  acdx
)
}
\description{
This function estimates the best FP functions for all predictors in the
current cycle. To be used in \code{\link[=fit_mfp]{fit_mfp()}}.
}
\details{
A cycle is defined as a pass through all of the predictors in the input
matrix \code{x}. A step is defined as the assessment of a single predictor.
This algorithm is described in Sauerbrei et al (2006) and given in detail
in Royston and Sauerbrei (2008), in particular chapter 6.

Briefly, a cycle works as follows. It has as input the data matrix and a set
of current best fp powers for each variable. In each step, the fp powers of a
single covariate are assessed.
To do this, all of the other variables are transformed as defined by the
current powers (this is done in \code{\link[=transform_data_step]{transform_data_step()}}) and the
fp powers of the variable of interest are tested using the closed test
procedure (done in \code{\link[=find_best_fp_step]{find_best_fp_step()}}). Some of the adjustment variables
may have their fp power set to \code{NA}, which means they were deselected from
the working model and are not used in that step.
The results from all steps are collected and returned, completing a cycle.

Note that each cycle goes through all variables. In particular that means
even if a variable was eliminated in an earlier cycle, it will re-enter
each new cycle at the beginning to be evaluated to be added to the
working model or to be eliminated again.

The current adjustment set is always given through the current fp powers,
which are updated in each step (denoted as \code{powers_current}).
}
\references{
Royston, P. and Sauerbrei, W., 2008. \emph{Multivariable Model - Building:
A Pragmatic Approach to Regression Anaylsis based on Fractional Polynomials
for Modelling Continuous Variables. John Wiley & Sons.}\cr
Sauerbrei, W., Meier-Hirmer, C., Benner, A. and Royston, P., 2006.
\emph{Multivariable regression model building by using fractional
polynomials: Description of SAS, STATA and R programs.
Comput Stat Data Anal, 50(12): 3464-85.}
Sauerbrei, W. and Royston, P., 1999. \emph{Building multivariable prognostic
and diagnostic models: transformation of the predictors by using fractional
polynomials. J Roy Stat Soc a Sta, 162:71-94.}
}
